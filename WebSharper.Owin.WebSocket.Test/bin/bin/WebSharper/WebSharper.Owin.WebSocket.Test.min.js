(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;a=self;b=a.testFrom0=a.testFrom0||{};c=b.Client=b.Client||{};d=a.WebSharper$Owin$WebSocket$Test_JsonEncoder=a.WebSharper$Owin$WebSocket$Test_JsonEncoder||{};e=a.WebSharper$Owin$WebSocket$Test_JsonDecoder=a.WebSharper$Owin$WebSocket$Test_JsonDecoder||{};f=a.GeneratedPrintf=a.GeneratedPrintf||{};g=a.WebSharper;h=g&&g.Html;i=h&&h.Client;j=i&&i.Tags;k=g&&g.Concurrency;l=a.jQuery;m=g&&g.Utils;n=g&&g.Owin;o=n&&n.WebSocket;p=o&&o.Client;q=p&&p.WithEncoding;r=a.JSON;s=a.IntelliFactory;t=s&&s.Runtime;u=g&&g.UI;v=u&&u.Next;w=v&&v.Doc;x=v&&v.Var;y=v&&v.View;z=g&&g.Strings;A=g&&g.Arrays;B=v&&v.Submitter;C=g&&g.Remoting;D=C&&C.AjaxRemotingProvider;E=v&&v.AttrProxy;F=g&&g.ClientSideJson;G=F&&F.Provider;c.WS=function(H){var I,J;function K(L){return L(function(M){I.Dom.appendChild(self.document.createTextNode(M+"\n"));});}I=j.Tags().NewTag("pre",[]);k.Start((J=null,k.Delay(function(){var L;K(function(M){return M("Checking regression #4...");});l.ajax((L={},L.url="/ws.txt",L.method="GET",L.success=function(M){return(K(function(N){return function(O){return N(m.toSafe(O));};}))(M);},L.error=function(M,N,O){return(K(function(P){return function(Q){return P("KO: "+m.toSafe(Q)+".");};}))(O);},L));return k.Bind(q.ConnectStateful(function(M){return r.stringify((d.j())(M));},function(M){return(e.j())(r.parse(M));},H,function(){var M;M=null;return k.Delay(function(){return k.Return([0,function(N){return function(O){var P;P=null;return k.Delay(function(){var Q;return O.$==3?(K(function(R){return R("WebSocket connection closed.");}),k.Return(N)):O.$==2?(K(function(R){return R("WebSocket connection open.");}),k.Return(N)):O.$==1?(K(function(R){return R("WebSocket connection error!");}),k.Return(N)):(Q=O.$0,k.Combine(Q.$==0?(((K(t.Curried3(function(R,S,T){return R("Response2 "+a.String(S)+" (state: "+a.String(T)+")");})))(Q.$0))(N),k.Zero()):Q.$==2?((K(function(R){return function(S){return R("Resp3 "+f.p(S));};}))(Q.$0),k.Zero()):(((K(t.Curried3(function(R,S,T){return R("Response1 "+m.toSafe(S)+" (state: "+a.String(T)+")");})))(Q.$0))(N),k.Zero()),k.Delay(function(){return k.Return(N+1);})));});};}]);});}),function(M){return k.While(function(){return true;},k.Delay(function(){return k.Bind(k.Sleep(1000),function(){M.Post({$:2,$0:{name:{"first-name":"John",LastName:"Doe"},age:42}});return k.Zero();});}));});})),null);return I;};c.fsi=function(H){w.RunById("main",H);return w.Empty();};c.m2=function(){var H,I,J;H=x.Create$1("orz");I=y.Map(function(K){return(function(L){return function(M){return L("You entered "+a.String(M)+" characters.");};}(a.id))(K);},y.Map(z.length,H.v));J=w.BindView(function(K){return w.Concat(A.map(function(L){return w.Element("li",[],[w.TextNode(L)]);},K));},y.Map(function(K){return z.SplitChars(K,[" "],0);},H.v));return w.Element("div",[],[w.Element("div",[],[w.Input([],H),w.TextView(I)]),w.Element("div",[],[w.TextNode("You entered the following words:"),w.Element("ul",[],[J])])]);};c.Main=function(){var H,I,J;H=x.Create$1("");I=B.CreateOption(H.v);J=y.MapAsync(function(K){var L;return K!=null&&K.$==1?(new D.New()).Async("WebSharper.Owin.WebSocket.Test:testFrom0.Server.DoSomething:-1840423385",[K.$0]):(L=null,k.Delay(function(){return k.Return("");}));},I.view);w.RunById("navbar",w.Element("div",[],[w.TextNode("This goes into #main.")]));return w.Element("div",[],[w.Input([],H),w.Button("Send",[],function(){I.Trigger();}),w.Element("hr",[],[]),w.Element("h4",[E.Create("class","text-muted")],[w.TextNode("The server responded:")]),w.Element("div",[E.Create("class","jumbotron")],[w.Element("h1",[],[w.TextView(J)])])]);};d.j=function(){return d._v?d._v:d._v=(G.EncodeUnion(void 0,{age:2,"int":1,str:0},[["Request1",[["$0","str",G.EncodeArray(G.Id()),0]]],["Request2",[["$0","int",G.EncodeArray(G.Id()),0]]],["Req3",[[null,true,G.Id()]]]]))();};e.j=function(){return e._v?e._v:e._v=(G.DecodeUnion(void 0,"type",[["int",[["$0","value",G.Id(),0]]],["string",[["$0","value",G.Id(),0]]],["name",[["$0","value",G.Id(),0]]]]))();};f.p=function(H){return"{"+("FirstName = "+m.prettyPrint(H["first-name"]))+"; "+("LastName = "+m.prettyPrint(H.LastName))+"}";};}());
